<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modul Biodiversiti Komprehensif</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .correct-answer { border: 2px solid #10b981; background-color: #f0fdf4; }
        .wrong-answer { border: 2px solid #ef4444; background-color: #fef2f2; }
        .note-card { border-left: 4px solid #059669; }
        .animate-fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">

    <!-- Header -->
    <header class="bg-emerald-900 text-white shadow-lg sticky top-0 z-50">
        <div class="max-w-4xl mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold tracking-tight text-emerald-100">BIODIVERSITI T2</h1>
            <div class="flex gap-4">
                <button onclick="showSection('notes')" id="btn-notes" class="text-sm font-semibold hover:text-emerald-200 underline decoration-2 underline-offset-4">Nota</button>
                <button onclick="startQuiz()" id="btn-quiz" class="text-sm font-semibold bg-emerald-600 px-4 py-2 rounded-lg hover:bg-emerald-500 transition shadow-md">Mula Kuiz (50 Soalan)</button>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-6 py-10">
        
        <!-- SEKSYEN NOTA (KEKALKAN SEDIA ADA) -->
        <div id="notes-section" class="space-y-12">
            <section class="space-y-6">
                <h2 class="text-3xl font-extrabold text-emerald-900 border-b-4 border-emerald-200 pb-2">1. Pengenalan Biodiversiti</h2>
                <div class="grid gap-4">
                    <div class="bg-white p-6 rounded-xl shadow-sm note-card">
                        <h3 class="font-bold text-lg mb-2">Definisi & Kedudukan Malaysia</h3>
                        <p class="text-slate-700 leading-relaxed">Kepelbagaian organisma (mikroorganisma, haiwan, tumbuhan) yang hidup di pelbagai habitat dan ekosistem. Kedudukan Malaysia sebagai salah satu daripada <strong>12 negara Mega Biodiversiti</strong> dunia perlu dipelihara bagi mengekalkan khazanah alam yang unik.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm note-card border-l-orange-500">
                        <h3 class="font-bold text-lg mb-2">Kepentingan</h3>
                        <ul class="list-disc ml-5 space-y-1 text-slate-700">
                            <li><strong>Sumber Makanan:</strong> Membekalkan protein dan karbohidrat.</li>
                            <li><strong>Keseimbangan Alam:</strong> Kitar oksigen, kitar karbon, dan pendebungaan.</li>
                            <li><strong>Perubatan:</strong> Tumbuhan herba untuk ubat-ubatan tradisional dan moden.</li>
                            <li><strong>Ekonomi:</strong> Ekopelancongan dan industri berasaskan biologi.</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="space-y-6">
                <h2 class="text-3xl font-extrabold text-emerald-900 border-b-4 border-emerald-200 pb-2">2. Pengkelasan Haiwan</h2>
                <div class="space-y-4">
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <h3 class="font-bold text-xl mb-4 text-emerald-700">A. Invertebrata (Tanpa Tulang Belakang)</h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="p-4 bg-slate-50 rounded-lg">
                                <h4 class="font-bold text-sm uppercase text-slate-500 mb-2">Tanpa Kaki</h4>
                                <ul class="text-sm space-y-1">
                                    <li>‚Ä¢ Badan bersegmen (Cacing tanah, lintah)</li>
                                    <li>‚Ä¢ Badan tidak bersegmen (Siput, planaria)</li>
                                </ul>
                            </div>
                            <div class="p-4 bg-slate-50 rounded-lg">
                                <h4 class="font-bold text-sm uppercase text-slate-500 mb-2">Berkaki</h4>
                                <ul class="text-sm space-y-1">
                                    <li>‚Ä¢ 3 pasang kaki (Semut, pepatung)</li>
                                    <li>‚Ä¢ Lebih 3 pasang kaki (Labah-labah, udang)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <h3 class="font-bold text-xl mb-4 text-emerald-700">B. Vertebrata (Bertulang Belakang)</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full border-collapse text-sm">
                                <thead>
                                    <tr class="bg-emerald-50 text-emerald-900">
                                        <th class="border p-3 text-left">Kumpulan</th>
                                        <th class="border p-3 text-left">Ciri-Ciri Utama</th>
                                        <th class="border p-3 text-left">Contoh</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="border p-3 font-bold">Ikan</td>
                                        <td class="border p-3">Poikilotera, bersisik lendir, bernafas guna insang, persenyawaan luar.</td>
                                        <td class="border p-3">Ikan emas, Ikan yu</td>
                                    </tr>
                                    <tr class="bg-slate-50">
                                        <td class="border p-3 font-bold">Amfibia</td>
                                        <td class="border p-3">Poikilotera, kulit lembap, anak bernafas guna insang, dewasa guna peparu/kulit.</td>
                                        <td class="border p-3">Katak, Kodok</td>
                                    </tr>
                                    <tr>
                                        <td class="border p-3 font-bold">Reptilia</td>
                                        <td class="border p-3">Poikilotera, kulit bersisik kering, bernafas guna peparu, persenyawaan dalam.</td>
                                        <td class="border p-3">Ular, Kura-kura</td>
                                    </tr>
                                    <tr class="bg-slate-50">
                                        <td class="border p-3 font-bold">Burung</td>
                                        <td class="border p-3">Homoiotera, berbulu pelepah, bernafas guna peparu, tulang berongga.</td>
                                        <td class="border p-3">Helang, Burung unta</td>
                                    </tr>
                                    <tr>
                                        <td class="border p-3 font-bold">Mamalia</td>
                                        <td class="border p-3">Homoiotera, berbulu/rambut, bernafas guna peparu, beranak & menyusu anak.</td>
                                        <td class="border p-3">Kucing, Paus, Kelawar</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <section class="space-y-6">
                <h2 class="text-3xl font-extrabold text-emerald-900 border-b-4 border-emerald-200 pb-2">3. Pengkelasan Tumbuhan</h2>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm note-card border-l-slate-400">
                        <h3 class="font-bold text-lg mb-3">Tumbuhan Tidak Berbunga</h3>
                        <ul class="space-y-2 text-sm text-slate-700">
                            <li><strong>Lumut:</strong> Tiada sistem vaskular, membiak guna spora.</li>
                            <li><strong>Paku Pakis:</strong> Ada sistem vaskular, membiak guna spora.</li>
                            <li><strong>Konifer:</strong> Membiak dengan menghasilkan kon.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm note-card border-l-yellow-400">
                        <h3 class="font-bold text-lg mb-3">Tumbuhan Berbunga</h3>
                        <div class="space-y-4">
                            <div class="p-3 border rounded-lg">
                                <span class="font-bold text-emerald-700">Monokotiledon:</span> Satu kotiledon, akar serabut, daun urat selari (Jagung, Padi).
                            </div>
                            <div class="p-3 border rounded-lg">
                                <span class="font-bold text-emerald-700">Dikotiledon:</span> Dua kotiledon, akar tunjang, daun urat jejala (Mangga, Rambutan).
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="space-y-6">
                <h2 class="text-3xl font-extrabold text-emerald-900 border-b-4 border-emerald-200 pb-2">4. Pengurusan Biodiversiti</h2>
                <div class="grid gap-6">
                    <div class="bg-rose-50 p-6 rounded-xl border-l-4 border-rose-500 shadow-sm">
                        <h3 class="font-bold text-xl mb-3 text-rose-900">Kesan Aktiviti Manusia</h3>
                        <ul class="list-disc ml-5 space-y-2 text-sm text-rose-800">
                            <li><strong>Penyahhutanan:</strong> Kemusnahan habitat asal bagi tujuan pembangunan atau pertanian.</li>
                            <li><strong>Pencemaran:</strong> Pencemaran air, udara, dan tanah yang menjejaskan kesihatan organisma.</li>
                            <li><strong>Pemburuan Haram:</strong> Menyebabkan kepupusan spesies endemik dan terancam.</li>
                            <li><strong>Pemanasan Global:</strong> Perubahan iklim menjejaskan kitaran hidup flora dan fauna.</li>
                        </ul>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm border border-emerald-200">
                        <h3 class="font-bold text-xl mb-4 text-emerald-800">Kaedah Pemeliharaan & Pemuliharaan</h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="p-4 bg-emerald-50 rounded-lg">
                                <h4 class="font-bold text-emerald-900 mb-2 italic">Pemeliharaan (In-situ)</h4>
                                <p class="text-xs text-slate-700 leading-relaxed">Mengekalkan spesies di habitat asal mereka. Contoh: Hutan Simpan, Taman Negara, Taman Laut.</p>
                            </div>
                            <div class="p-4 bg-slate-100 rounded-lg">
                                <h4 class="font-bold text-slate-800 mb-2 italic">Pemuliharaan (Ex-situ)</h4>
                                <p class="text-xs text-slate-700 leading-relaxed">Melindungi spesies di luar habitat asal mereka. Contoh: Zoo, Taman Botani, Bank Biji Benih.</p>
                            </div>
                        </div>
                        <div class="mt-4 p-4 border border-emerald-100 rounded-lg bg-white">
                            <h4 class="font-bold text-sm text-emerald-700 mb-2 uppercase">Spesies Endemik & Terancam</h4>
                            <p class="text-sm text-slate-600">Spesies endemik adalah spesies yang hanya terdapat di kawasan geografi tertentu (Contoh: Penyu, Harimau Malaya). Pemuliharaan intensif dilakukan melalui penguatkuasaan undang-undang dan pendidikan masyarakat.</p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- SEKSYEN KUIZ -->
        <div id="quiz-section" class="hidden animate-fade-in max-w-2xl mx-auto">
            <div class="mb-8 p-6 bg-slate-900 text-white rounded-2xl shadow-xl">
                <div class="flex justify-between items-center mb-2">
                    <h2 class="text-2xl font-black italic uppercase text-emerald-400">Peringkat Masteri</h2>
                    <span id="quiz-stat" class="text-xs bg-emerald-600 px-3 py-1 rounded-full font-bold">PUSINGAN 1</span>
                </div>
                <div class="flex justify-between text-[11px] text-slate-400 mb-2">
                    <span>Kemajuan Jawapan</span>
                    <span id="progress-text">0 / 0</span>
                </div>
                <div class="w-full bg-slate-800 h-2.5 rounded-full overflow-hidden">
                    <div id="progress-bar" class="bg-emerald-500 h-full transition-all duration-700 ease-in-out" style="width: 0%"></div>
                </div>
            </div>
            <div id="question-container" class="space-y-6"></div>
            <div class="mt-12 flex justify-center">
                <button id="submit-btn" onclick="evaluateQuiz()" class="bg-emerald-700 text-white px-16 py-4 rounded-2xl font-bold text-xl shadow-lg hover:bg-emerald-600 transition-all transform active:scale-95 hover:shadow-emerald-200/50">
                    Hantar & Semak
                </button>
            </div>
        </div>

        <!-- SEKSYEN REVIEW -->
        <div id="review-section" class="hidden animate-fade-in max-w-2xl mx-auto space-y-6">
            <div class="p-6 bg-amber-50 border-l-4 border-amber-500 rounded-xl">
                <h3 class="text-xl font-bold text-amber-900">Analisis Pusingan</h3>
                <p id="review-summary" class="text-amber-800 text-sm mt-1"></p>
            </div>
            <div id="review-list" class="space-y-4"></div>
            <div class="flex justify-center pt-8">
                <button onclick="retryWrongOnes()" class="bg-orange-600 text-white px-12 py-4 rounded-2xl font-bold text-lg shadow-xl hover:bg-orange-500 transition-all flex items-center gap-3">
                    <span>üîÅ</span> Cuba Semula Soalan Salah
                </button>
            </div>
        </div>

        <!-- SEKSYEN MOTIVASI FINAL -->
        <div id="success-section" class="hidden animate-fade-in text-center py-16">
            <div class="mb-8 inline-block p-6 bg-white rounded-full shadow-2xl animate-bounce">
                <span class="text-7xl">üéØ</span>
            </div>
            <h1 class="text-5xl font-black text-emerald-900 mb-6 leading-tight uppercase tracking-tighter">KEJAYAAN MUTLAK MILIK ANDA!</h1>
            
            <div class="bg-white p-10 rounded-[2.5rem] shadow-2xl max-w-xl mx-auto border-b-[12px] border-emerald-600 relative overflow-hidden">
                <div class="absolute top-0 right-0 p-4 opacity-10 text-8xl">üå±</div>
                <p class="text-2xl text-slate-800 font-medium italic leading-relaxed relative z-10">
                    "Tahniah, Pejuang Ilmu! Anda bukan sahaja telah menjawab semua soalan dengan betul, tetapi anda telah membuktikan bahawa <span class="text-emerald-700 font-bold">ketekalan</span> dan <span class="text-emerald-700 font-bold">keazaman</span> adalah kunci kepada setiap pintu kejayaan."
                </p>
                <div class="mt-8 pt-8 border-t border-slate-100">
                    <p class="text-slate-600">
                        Anda kini sebahagian daripada komuniti yang menghargai khazanah alam. Teruskan mengejar impian anda dengan semangat yang sama hebatnya seperti hari ini!
                    </p>
                </div>
            </div>
            
            <div class="mt-12 flex justify-center gap-4">
                <button onclick="location.reload()" class="bg-slate-900 text-white px-8 py-3 rounded-xl font-bold hover:bg-slate-800 transition">Kembali ke Nota</button>
            </div>
        </div>

    </main>

    <script>
        // Bank Soalan 50 (25R, 15S, 10T)
        const MASTER_QUESTIONS = [
            // ARAS RENDAH (25)
            { id: 1, q: "Berapakah bilangan negara Mega Biodiversiti di dunia?", options: ["10", "12", "15", "18"], correct: 1, lv: "R" },
            { id: 2, q: "Biodiversiti merujuk kepada kepelbagaian...", options: ["Batu batan", "Organisma hidup", "Jenis kenderaan", "Suhu persekitaran"], correct: 1, lv: "R" },
            { id: 3, q: "Contoh haiwan vertebrata ialah...", options: ["Semut", "Katak", "Cacing", "Siput"], correct: 1, lv: "R" },
            { id: 4, q: "Invertebrata bermaksud haiwan yang...", options: ["Tiada tulang belakang", "Ada tulang belakang", "Tiada kaki", "Ada sayap"], correct: 0, lv: "R" },
            { id: 5, q: "Mamalia bernafas menggunakan...", options: ["Insang", "Trakea", "Peparu", "Kulit"], correct: 2, lv: "R" },
            { id: 6, q: "Ikan adalah haiwan ___ (suhu badan berubah).", options: ["Homoiotera", "Poikilotera", "Ektotermik", "Endotermik"], correct: 1, lv: "R" },
            { id: 7, q: "Katak tergolong dalam kumpulan...", options: ["Reptilia", "Amfibia", "Ikan", "Burung"], correct: 1, lv: "R" },
            { id: 8, q: "Tumbuhan berbunga dibahagi kepada monokotiledon dan ___.", options: ["Lumut", "Dikotiledon", "Konifer", "Paku pakis"], correct: 1, lv: "R" },
            { id: 9, q: "Paku pakis membiak melalui...", options: ["Biji benih", "Spora", "Kon", "Keratan"], correct: 1, lv: "R" },
            { id: 10, q: "Habitat bagi unta ialah...", options: ["Hutan hujan", "Padang pasir", "Lautan", "Kutub Utara"], correct: 1, lv: "R" },
            { id: 11, q: "Contoh pemuliharaan in-situ ialah...", options: ["Zoo", "Taman Negara", "Taman Botani", "Bank Benih"], correct: 1, lv: "R" },
            { id: 12, q: "Ular mempunyai kulit yang...", options: ["Lembap", "Bersisik kering", "Berbulu", "Berlendir"], correct: 1, lv: "R" },
            { id: 13, q: "Burung mempunyai tulang yang ___ untuk terbang.", options: ["Padat", "Berongga", "Berat", "Lentur"], correct: 1, lv: "R" },
            { id: 14, q: "Pokok jagung mempunyai akar ___.", options: ["Tunjang", "Serabut", "Gantung", "Sokong"], correct: 1, lv: "R" },
            { id: 15, q: "Tumbuhan dikotiledon mempunyai urat daun ___.", options: ["Selari", "Jejala", "Lurus", "Tiada urat"], correct: 1, lv: "R" },
            { id: 16, q: "Siput adalah invertebrata yang...", options: ["Berkaki", "Tanpa kaki", "Bersayap", "Bertulang"], correct: 1, lv: "R" },
            { id: 17, q: "Penyahhutanan menyebabkan kehilangan ___ organisma.", options: ["Warna", "Habitat", "Nama", "Suara"], correct: 1, lv: "R" },
            { id: 18, q: "Pencemaran air boleh mematikan ___.", options: ["Burung", "Hidupan akuatik", "Mamalia darat", "Pokok kaktus"], correct: 1, lv: "R" },
            { id: 19, q: "Ubi kayu membiak secara ___.", options: ["Spora", "Biji benih", "Keratan batang", "Daun"], correct: 2, lv: "R" },
            { id: 20, q: "Contoh haiwan endemik Malaysia ialah...", options: ["Singa", "Penyu", "Kanggaru", "Zirafah"], correct: 1, lv: "R" },
            { id: 21, q: "Apakah alat pernafasan berudu?", options: ["Peparu", "Insang", "Kulit", "Trakea"], correct: 1, lv: "R" },
            { id: 22, q: "Tumbuhan manakah yang tidak berbunga?", options: ["Ros", "Lumut", "Orkid", "Bunga raya"], correct: 1, lv: "R" },
            { id: 23, q: "Arnab adalah kumpulan vertebrata...", options: ["Reptilia", "Mamalia", "Amfibia", "Burung"], correct: 1, lv: "R" },
            { id: 24, q: "Paus adalah haiwan...", options: ["Ikan", "Mamalia", "Reptilia", "Amfibia"], correct: 1, lv: "R" },
            { id: 25, q: "In-situ bermaksud perlindungan di habitat ___.", options: ["Luar", "Asal", "Buatan", "Makmal"], correct: 1, lv: "R" },

            // ARAS SEDERHANA (15)
            { id: 26, q: "Mengapakah Malaysia dipanggil negara Mega Biodiversiti?", options: ["Sangat luas", "Banyak bangunan", "Kaya dengan spesies flora & fauna", "Ramai penduduk"], correct: 2, lv: "S" },
            { id: 27, q: "Antara berikut, yang manakah kepentingan biodiversiti kepada perubatan?", options: ["Sumber protein", "Herba sebagai ubat", "Keseimbangan karbon", "Ekopelancongan"], correct: 1, lv: "S" },
            { id: 28, q: "Ciri utama yang membezakan mamalia daripada vertebrata lain?", options: ["Bernafas guna peparu", "Menyusukan anak", "Berdarah sejuk", "Bertelur"], correct: 1, lv: "S" },
            { id: 29, q: "Apakah kelebihan sistem vaskular pada pokok?", options: ["Untuk membiak", "Untuk angkut air & nutrien", "Untuk hasilkan spora", "Untuk tarik serangga"], correct: 1, lv: "S" },
            { id: 30, q: "Mengapa pemanasan global membimbangkan biodiversiti?", options: ["Haiwan jadi aktif", "Habitat kutub mencair", "Tumbuhan makin subur", "Hujan berkurang"], correct: 1, lv: "S" },
            { id: 31, q: "Kunci dikotomus digunakan untuk...", options: ["Kira jumlah haiwan", "Kelaskan organisma secara sistematik", "Cari makanan haiwan", "Ukur saiz tumbuhan"], correct: 1, lv: "S" },
            { id: 32, q: "Manakah ciri monokotiledon?", options: ["Dua kotiledon", "Akar tunjang", "Satu kotiledon", "Daun urat jejala"], correct: 2, lv: "S" },
            { id: 33, q: "Apakah peranan Zoo dalam biodiversiti?", options: ["Pemeliharaan in-situ", "Pemuliharaan ex-situ", "Penyahhutanan", "Pertanian"], correct: 1, lv: "S" },
            { id: 34, q: "Aktiviti manakah yang paling mengancam spesies endemik?", options: ["Pertanian organik", "Pemburuan haram", "Kitar semula", "Tanam semula"], correct: 1, lv: "S" },
            { id: 35, q: "Bagaimanakah kitar oksigen dibantu oleh biodiversiti?", options: ["Haiwan bernafas", "Tumbuhan berfotosintesis", "Pencemaran udara", "Penebangan pokok"], correct: 1, lv: "S" },
            { id: 36, q: "Apakah kesan pembinaan empangan terhadap biodiversiti?", options: ["Tambah habitat sungai", "Musnahkan habitat hutan & ganggu aliran", "Tingkatkan jumlah ikan", "Bersihkan air"], correct: 1, lv: "S" },
            { id: 37, q: "Suhu badan homoiotera adalah...", options: ["Malar/Tetap", "Berubah mengikut air", "Sentiasa 0 darjah", "Berubah mengikut tanah"], correct: 0, lv: "S" },
            { id: 38, q: "Konifer membiak menggunakan...", options: ["Bunga", "Kon", "Spora", "Anak pokok"], correct: 1, lv: "S" },
            { id: 39, q: "Amfibia dewasa bernafas menggunakan peparu dan ___.", options: ["Insang", "Kulit lembap", "Trakea", "Mulut"], correct: 1, lv: "S" },
            { id: 40, q: "Bank Biji Benih bertujuan untuk...", options: ["Jual benih", "Simpan benih spesies terancam", "Beri makan burung", "Hiasan taman"], correct: 1, lv: "S" },

            // ARAS SUKAR (10)
            { id: 41, q: "Manakah susunan yang betul bagi membina kunci dikotomus?", options: ["Berdasarkan warna", "Berdasarkan ciri bertentangan (dua pilihan)", "Berdasarkan berat", "Berdasarkan umur"], correct: 1, lv: "T" },
            { id: 42, q: "Apakah kelemahan utama pemuliharaan ex-situ?", options: ["Kos murah", "Sukar adaptasi jika dilepas ke habitat asal", "Terlalu banyak ruang", "Haiwan jadi liar"], correct: 1, lv: "T" },
            { id: 43, q: "Platypus adalah unik kerana ia mamalia yang...", options: ["Berdarah sejuk", "Bertelur", "Tiada peparu", "Hidup dalam air masin"], correct: 1, lv: "T" },
            { id: 44, q: "Sistem vaskular terdiri daripada xilem dan phloem. Paku pakis mempunyai ciri ini tetapi ___ tidak.", options: ["Konifer", "Lumut", "Pokok durian", "Padi"], correct: 1, lv: "T" },
            { id: 45, q: "Mengapa persenyawaan luar memerlukan bilangan telur yang banyak?", options: ["Supaya ikan kenyang", "Tingkatkan peluang kemandirian kerana banyak musuh", "Hasilkan ikan besar", "Warna telur cantik"], correct: 1, lv: "T" },
            { id: 46, q: "Bagaimanakah spesies perosak biologi membantu biodiversiti?", options: ["Guna racun kimia", "Kawal populasi perosak secara semulajadi", "Tambah pencemaran", "Hapuskan semua serangga"], correct: 1, lv: "T" },
            { id: 47, q: "Pemanasan global mengganggu ___ organisma menyebabkan kepupusan.", options: ["Kitaran pembiakan", "Warna mata", "Saiz telinga", "Kelajuan larian"], correct: 0, lv: "T" },
            { id: 48, q: "Manakah perbezaan utama antara reptilia dan amfibia?", options: ["Reptilia bertelur", "Reptilia mempunyai kulit bersisik kering", "Reptilia berdarah sejuk", "Reptilia bernafas"], correct: 1, lv: "T" },
            { id: 49, q: "Fungsi utama 'klorofil' pada tumbuhan dalam ekosistem ialah...", options: ["Hasilkan oksigen melalui fotosintesis", "Beri bau wangi", "Tarik perhatian burung", "Sejukkan pokok"], correct: 0, lv: "T" },
            { id: 50, q: "Bagaimanakah pembangunan lestari memberi kesan kepada biodiversiti?", options: ["Musnahkan semua hutan", "Menyeimbangkan keperluan manusia & alam", "Hanya pentingkan keuntungan", "Bina banyak zoo sahaja"], correct: 1, lv: "T" }
        ];

        let currentActiveSet = []; // Soalan yang sedang dijawab
        let userResponses = {}; 
        let currentRound = 1;

        function showSection(id) {
            ['notes-section', 'quiz-section', 'review-section', 'success-section'].forEach(s => {
                document.getElementById(s).classList.add('hidden');
            });
            document.getElementById(id + '-section').classList.remove('hidden');
            
            const isQuizMode = (id !== 'notes');
            document.getElementById('btn-notes').classList.toggle('hidden', isQuizMode);
            document.getElementById('btn-quiz').classList.toggle('hidden', isQuizMode);
        }

        function startQuiz() {
            currentActiveSet = [...MASTER_QUESTIONS];
            userResponses = {};
            currentRound = 1;
            showSection('quiz');
            renderQuestions();
            updateProgress();
        }

        function renderQuestions() {
            const container = document.getElementById('question-container');
            document.getElementById('quiz-stat').innerText = `PUSINGAN ${currentRound}`;
            
            container.innerHTML = currentActiveSet.map((q, idx) => `
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 animate-fade-in" style="animation-delay: ${idx * 0.05}s">
                    <div class="flex items-center gap-2 mb-4">
                        <span class="px-2 py-0.5 rounded bg-slate-100 text-[10px] font-bold text-slate-500 uppercase">
                            Aras: ${q.lv === 'R' ? 'Rendah' : q.lv === 'S' ? 'Sederhana' : 'Tinggi'}
                        </span>
                        <span class="text-xs text-slate-400">#${q.id}</span>
                    </div>
                    <p class="font-bold text-lg text-slate-800 leading-tight mb-5">${q.q}</p>
                    <div class="grid gap-2.5">
                        ${q.options.map((opt, i) => `
                            <button onclick="pickOption(${idx}, ${i})" id="q-${idx}-o-${i}" 
                                class="option-btn text-left p-4 rounded-xl border-2 border-slate-100 bg-slate-50 hover:border-emerald-300 transition-all text-sm flex items-center gap-3 group">
                                <span class="w-7 h-7 rounded-lg bg-white border flex items-center justify-center font-bold text-xs group-hover:bg-emerald-100">${String.fromCharCode(65+i)}</span>
                                <span class="flex-1">${opt}</span>
                            </button>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function pickOption(qIdx, oIdx) {
            userResponses[qIdx] = oIdx;
            // Reset styles
            document.querySelectorAll(`[id^='q-${qIdx}-o-']`).forEach(btn => {
                btn.className = btn.className.replace('border-emerald-600 bg-emerald-50 shadow-inner', 'border-slate-100 bg-slate-50');
            });
            // Apply selected style
            const target = document.getElementById(`q-${qIdx}-o-${oIdx}`);
            target.className = target.className.replace('border-slate-100 bg-slate-50', 'border-emerald-600 bg-emerald-50 shadow-inner');
            updateProgress();
        }

        function updateProgress() {
            const answered = Object.keys(userResponses).length;
            const total = currentActiveSet.length;
            const pct = total > 0 ? (answered / total) * 100 : 0;
            document.getElementById('progress-bar').style.width = pct + '%';
            document.getElementById('progress-text').innerText = `${answered} / ${total}`;
        }

        function evaluateQuiz() {
            if (Object.keys(userResponses).length < currentActiveSet.length) {
                alert("Opps! Sila jawab semua soalan dalam pusingan ini sebelum menghantar.");
                return;
            }

            const wrongSet = [];
            const reviewList = document.getElementById('review-list');
            reviewList.innerHTML = '';

            currentActiveSet.forEach((q, idx) => {
                const selected = userResponses[idx];
                const isCorrect = selected === q.correct;
                
                const card = document.createElement('div');
                card.className = `p-5 rounded-2xl border-2 transition-all ${isCorrect ? 'correct-answer' : 'wrong-answer'}`;
                card.innerHTML = `
                    <div class="flex justify-between items-start gap-4">
                        <div class="flex-1">
                            <p class="font-bold text-slate-800">${isCorrect ? '‚úÖ' : '‚ùå'} ${q.q}</p>
                            <div class="mt-2 flex flex-wrap gap-x-4 gap-y-1 text-sm">
                                <span class="text-slate-500">Jawapan Anda: <b class="${isCorrect ? 'text-emerald-700' : 'text-rose-700'}">${q.options[selected]}</b></span>
                                ${!isCorrect ? `<span class="text-emerald-700 font-black italic underline">Betul: ${q.options[q.correct]}</span>` : ''}
                            </div>
                        </div>
                    </div>
                `;
                reviewList.appendChild(card);
                if (!isCorrect) wrongSet.push(q);
            });

            if (wrongSet.length === 0) {
                showSection('success');
            } else {
                currentActiveSet = [...wrongSet];
                document.getElementById('review-summary').innerText = `Hebat! Anda berjaya menjawab ${MASTER_QUESTIONS.length - wrongSet.length}/${MASTER_QUESTIONS.length} dengan betul. Hanya tinggal ${wrongSet.length} lagi soalan untuk dikuasai.`;
                showSection('review');
            }
        }

        function retryWrongOnes() {
            userResponses = {};
            currentRound++;
            showSection('quiz');
            renderQuestions();
            updateProgress();
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        // Init
        window.onload = () => showSection('notes');
    </script>
</body>
</html>
